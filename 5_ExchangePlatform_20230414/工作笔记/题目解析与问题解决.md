### 题目重述

**交易兔平台**

#### 简介

二手游戏账号交易平台，参考交易游或闲鱼 平台支持功能 支持交易流程



#### 流程

卖家挂出账号——>管理员审核决定是否上架——（如果否）>拒绝消息发送 给卖家

卖家挂出账号——>管理员审核决定是否上架——（如果是）>商品上架——>买家看商品——>买家决定是否出价——(如果是)——>出价发送卖家——>买卖家交流

买家决定是否出价——(如果否)——>买卖家交流

商品上架——>卖家修改商品信息或价格

买卖家交流——>确定交易价格——>买家支付支付金暂存平台——>买卖家收到系统消息——>卖家决定交货

卖家决定交货——>（如果否）——>交易取消,系统通知买家, 支付金返回买家手中

卖家决定交货——>（如果是）——>买家收货系统将账号信息发送给买家——>买家验货

买家验货——>(否)——>系统通知卖家——>卖家检查账号 并处理账号——>卖家决定是否取消交易——>交易取消,系统通知买家, 支付金返回买家手中

买家验货——（是）——>结束交易——>平台将支付金按协议比例发给卖家, 并对交易进行备案

卖家决定是否取消交易——（否）——>卖家提交账号或交易问题——>支付金暂存平台,将交易放入问题备案



#### 支持聊天功能

支持文字、图片交流

保存聊天记录

支持屏蔽功能

有聊天界面和消息提醒

可以接收系统发送通知



#### 支持黑名单功能

用户举报或平台检测 

↓

管理员审核，决定加入黑名单 

↓

回复用户审核情况

黑名单用户只能使用充值和提现功能和接受系统消息，其他功能不允许使用，且昵称头像进行特殊处理



#### 支持后台审核

管理员权限： 审核商品，审核用户举报

管理员有处理事故的功



#### 支持个人中心

用户买卖家一体

个人中心可查看：

1. 个人信息： 用户名，昵称，头像，修改密码，绑定邮箱，实名认证
2. 买家中心：已购买订单，收藏订单，出价订单
3. 卖家中心：出售商品，已完成订单，买家的出价
4. 余额钱包： 充值，提现

#### 支持事故处理

目前主要有两大情况：

1. 交易完成后，卖家找回账号
   1) 处理手段：紧急冻结卖家钱包，管理员审核账号情况。情况属实，若卖家钱包足够交易价格，则按交易价 格返回给买家，解冻卖家钱包，将卖家加入黑名单； 若钱包不足交易价格，将钱包余额全数返回买家（平台可以自行补偿），并将卖家加入讨债列表和黑名单

2. 买家收货后，取消交易，卖家检查账户发现问题拒绝取消交易
   1. 处理手段：管理员审核账号情况。账号确实受损，如卖家同意，按照账号受损情况将交易金按协议比例发 给卖家，剩余交易金返回买家。
   2. 如账号价值严重受损，没有什么交易价值，则将交易金全部发给卖家，通知买家，且买家加入黑名单；如 卖家不同意，则进行协调程序。
   3. 账号并没有价值受损，则告知卖家，结束交易过程，交易金返还买家；如卖家不同意，则进行协调程序





### 问题与解决



#### **1. 写同一个项目，两个后端怎么对接呢**

![image-20230413183915679](C:\Users\Hong Langchen\AppData\Roaming\Typora\typora-user-images\image-20230413183915679.png)

#### **2. 前端和后端怎么对接呢**

* 前端和后端通常通过API进行对接，API是应用程序编程接口的缩写，是一组定义了前后端交互规则的接口。前端通过发送请求到后端API，后端返回响应给前端。具体的流程如下：

  1. 前端通过HTTP请求调用后端API，通常使用GET、POST等方法。
  2. 后端接收到请求后，处理请求并生成响应数据。
  3. 后端将响应数据封装成JSON等格式，并通过HTTP响应发送给前端。
  4. 前端解析响应数据，渲染到页面上。

  在实际开发中，前端和后端需要共同确定API的规范，包括请求方法、请求参数、响应格式等。通常可以使用RESTful API的规范来制定API。

#### 3. 用户信息中头像要如何保存在数据库？

保存头像到数据库的一种常见方式是将头像文件转换为二进制数据，然后将其存储在数据库的 BLOB 字段中。

具体步骤如下：

1. 在前端，用户上传头像后，将头像文件使用 JavaScript 的 FileReader API 读取成二进制数据，并发送到后端。也可以使用第三方的文件上传库，如 Dropzone.js 等。
2. 在后端，接收到请求后，**将接收到的二进制数据存储到数据库的 BLOB 字段中。**
3. 当需要显示用户头像时，**从数据库中读取 BLOB 字段并将其转换为二进制数据，然后将其显示为图片。**

需要注意的是，<u>将头像保存在数据库中可能会导致数据库变得很大，并且每次显示头像时都需要从数据库中读取数据，会增加数据库的负担</u>。因此，==<u>**更好的做法是将头像保存在服务器的文件系统中，并将头像的路径存储在数据库中**</u>==，这样可以避免这些问题。

通常情况下，<u>**前端**展示头像时可以通过图片的**URL**来获取并显示图片，而不需要将图片保存在展示者的电脑上。</u><u>**后端**应该将图片保存在**服务器**上，并在前端展示时，将图片的URL返回给前端，前端根据这个URL从服务器获取图片并显示。</u>

##### 支持离线访问

如果你们的项目需要支持离线访问，即没有网络连接的情况下也能正常显示头像，那么可以将头像的URL转换为Base64编码的字符串，然后在前端展示时将这个编码的字符串直接嵌入到HTML或CSS中。这样可以避免图片需要从服务器上下载的问题，但是会增加HTML或CSS的体积，导致页面加载速度变慢。



#### 4. 前后端的代码是不是要在一台电脑同时运行才可以使用？

不完全是。前端和后端的代码可以在不同的机器上运行，只要它们都能够互相访问到对方的地址即可。例如，前端代码可以运行在本地电脑上，后端代码可以运行在云服务器上，前端代码可以通过网络访问到后端的地址并获取数据。因此，只要保证前后端能够互相访问即可使用。

#### 5.  apipost中xx×-www-form-urlencoded和raw有什么区别

`application/x-www-form-urlencoded` 和 `raw` 是 HTTP 请求中两种不同的传参方式。

`application/x-www-form-urlencoded` 是一种标准的 HTTP 表单提交方式，用于提交 key-value 形式的数据。在这种传参方式下，数据被编码为名称/值对，以 '&' 分割，名称和值之间以 '=' 连接，例如 `name=John&age=30`。这种传参方式可以通过 GET 或 POST 方法提交，但通常使用 POST。

`raw` 则是 HTTP 请求中的另一种传参方式，常用于向后端传递 JSON、XML、文本等类型的数据。<u>在 `raw` 格式下，需要手动设置请求头，告知后端传递的数据类型，例如：`Content-Type: application/json`。此外，传递的数据需要以指定格式的字符串形式出现在请求体中，例如：`{"name": "John", "age": 30}`。</u>

一般来说，如果需要提交普通表单数据，使用 `application/x-www-form-urlencoded`；<u>如果需要提交非表单数据，如 JSON 格式的数据，使用 `raw` 传参方式。</u>







### 题目拆解

**Chatgpt：**

#### 全栈实现流程

这是一个比较复杂的项目，需要有完整的前端和后端的开发经验。下面是一个简单的实现流程：

1. 确定平台技术栈：前端可以选择 React、Vue 等框架，后端可以选择 Node.js、PHP 等语言，数据库可以选择 MySQL、MongoDB 等。
2. **<u>设计数据库表结构：包括用户表、商品表、订单表等。</u>**
3. 开发前端页面：实现注册、登录、个人中心、商品列表、交易流程等页面。
4. **实现后端逻辑：包括用户注册、登录、商品上传、订单处理、支付等逻辑。**
5. 进行测试和优化：测试所有功能是否正常，优化性能和用户体验。
6. 上线部署：将代码部署到云服务器或者使用云服务商提供的 PaaS 平台进行部署。

在具体实现过程中，还需要注意以下几点：

1. 确保系统安全：对用户上传的文件、数据库操作等进行安全性检查，**防止 SQL 注入、XSS 攻击等。**
2. 实现聊天功能：**使用 WebSocket 或者长轮询技术实现聊天功能，并且需要保存聊天记录。**
3. **实现黑名单功能：**管理员审核加入黑名单的用户，将黑名单用户的头像、昵称等进行特殊处理。
4. **实现后台审核功能：**管理员审核商品、用户举报等，需要管理员登录和权限验证。
5. **处理事故：**当出现账号受损等问题时，需要进行紧急处理，通知买家和卖家，并将卖家加入黑名单。
6. **保护用户隐私：**保护用户的个人信息和交易信息，不允许未授权的人员查看或使用。

#### 总述

**问题：**

1. 这个要求很复杂，请帮我整理并概括。 
2. 小组情况说明：我们小组有两个后端python，一个安卓，一个美术。我负责后端，请给我一个可行的后端分工
3. 3. 我的组长让我写用户注册登录的内容，请告诉我写这个项目用户注册登录存入数据库的属性要包括哪些，数据库可以如何设计，并告诉我具体要写哪些函数。
4. 4. 简述一下用户注册登录的接口文档大概怎么写，并举个示例 

**答案**

1. 交易兔平台是一个二手游戏账号交易平台，用户可以在该平台上挂出自己的游戏账号，并进行交易。平台的功能非常复杂，包括<u>商品上架、管理员审核、交易流程、聊天功能、黑名单功能、后台审核、个人中心、事故处理</u>等多个方面。

2. 可行的后端分工如下：

   + 后端1：<u>处理商品信息、商品上架、买卖家交流</u>等功能
   + 后端2：<u>处理账号信息、支付功能、个人信息</u>等功能

3. <u>**用户注册登录存入数据库**</u>的属性应该包括**<u>用户名、密码、邮箱、手机号、昵称、头像</u>**等信息。

   数据库可以设计成包含<u>**users**表和**user_details**表</u>

   1. 其中<u>users表存储**用户名、密码、邮箱、手机号**等信息</u>
   2. 而<u>user_details表存储**昵称、头像**等用户个人信息。</u>
   3. 需要编写以下函数：<u>**register()、login()、logout()**，分别用于**用户注册、用户登录、用户登出**。</u>

4. 用户注册登录接口文档应该包括<u>请求地址、请求参数、响应参数、错误码</u>等信息。例如：

   + <u>请求地址：/user/register</u>
   + <u>请求参数：{ "username": "xxx", "password": "xxx", "email": "xxx", "phone": "xxx", "nickname": "xxx", "avatar": "xxx" }</u>
   + <u>响应参数：{ "code": 200, "msg": "注册成功" }</u>
   + <u>错误码：{ "4001": "用户名已存在", "4002": "邮箱已被注册", "4003": "手机号已被注册", "5001": "服务器内部错误" }</u>

5. 能否在一个月内完成该项目取决于小组成员的技能水平和工作效率。考虑到该项目功能较为复杂，需要对各个模块进行详细设计和测试，因此需要合理分配时间，充分发挥小组成员的优势，尽可能<u>**减少不必要的浪费，加强沟通协调，才能在一个月内完成项目**</u>。

6. 根据项目的要求，你可以按照以下计划完成后端的开发工作：

   + 第1周：**完成项目的功能设计和数据库设计，确定后端的API接口**。
   + 第2-3周：开始编写后端代码，完成**==用户注册登录、商品信息管理、聊天功能、黑名单功能==**等核心功能。
   + 第4周：进行代码**测试和性能优化**，确保后端代码质量和运行效率。同时和前端团队协调，进行接口测试和联调。

#### 总任务总结

##### Part 1

1. 支持管理员审核挂出的账号，决定是否上架
2. 支持卖家修改商品信息或价格
3. 支持买卖家交流，包括确定交易价格和卖家决定交货
4. 支持系统通知和消息提醒
5. 支持支付功能，包括买家支付和提现，平台暂存支付金，和支付金按协议比例发给卖家
6. 支持交易完成后的事故处理，包括卖家找回账号和买家收货后取消交易等情况
7. 支持个人中心，包括个人信息，买家中心，卖家中心，余额钱包等功能

##### Part 2

1. 支持聊天功能，包括文字、图片交流，保存聊天记录，屏蔽功能，聊天界面和消息提醒
2. 支持黑名单功能，包括管理员审核加入黑名单，回复用户审核情况，黑名单用户只能使用充值和提现功能和接受系统消息，其他功能不允许使用，且昵称头像进行特殊处理
3. 支持后台审核，包括审核商品和审核用户举报，管理员有处理事故的功

<u>**针对以上功能，可以分成两个后端完成：**</u>

后端1：

1. 管理员审核挂出的账号，决定是否上架

2. 卖家修改商品信息或价格

3. 买卖家交流，包括确定交易价格和卖家决定交货

4. 系统通知和消息提醒

5. 支付功能，包括买家支付和提现，平台暂存支付金，和支付金按协议比例发给卖家

6. 交易完成后的事故处理，包括卖家找回账号和买家收货后取消交易等情况

7. 个人中心，个人信息

   

后端2：

1. 个人中心，包括，买家中心，卖家中心，余额钱包等功能
2. 聊天功能，包括文字、图片交流，保存聊天记录，屏蔽功能，聊天界面和消息提醒
3. 黑名单功能，包括管理员审核加入黑名单，回复用户审核情况，黑名单用户只能使用充值和提现功能和接受系统消息，其他功能不允许使用，且昵称头像进行特殊处理
4. 后台审核，包括审核商品和审核用户举报，管理员有处理事故的功

#### 流程图重述

1. 卖家挂出账号
2. 管理员审核决定是否上架 a. 如果否，拒绝消息发送给卖家 b. 如果是，商品上架
3. 买家看商品
4. 买家决定是否出价 a. 如果否，买卖家交流 b. 如果是，出价发送卖家
5. 买卖家交流
6. 确定交易价格
7. 买家支付支付金暂存平台
8. 买卖家收到系统消息
9. 卖家决定交货 a. 如果否，交易取消，系统通知买家，支付金返回买家手中 b. 如果是，买家收货系统将账号信息发送给买家
10. 买家验货 a. 如果否，系统通知卖家，卖家检查账号并处理账号，卖家决定是否取消交易，交易取消，系统通知买家，支付金返回买家手中 b. 如果是，结束交易，平台将支付金按协议比例发给卖家，并对交易进行备案
11. 卖家决定是否取消交易 a. 如果否，卖家提交账号或交易问题，支付金暂存平台，将交易放入问题备案

#### 流程图分工

![image-20230413201637661](C:\Users\Hong Langchen\AppData\Roaming\Typora\typora-user-images\image-20230413201637661.png)

**问题：**请帮我为这个流程中的任务进行后端任务分配，我们有两个能力相当的后端

**解答:**

**后端1：**

+ **负责卖家挂出账号、商品上架、卖家修改商品信息或价格等与卖家相关的功能实现；**
+ **负责支付功能的实现，包括买家支付支付金暂存平台和平台将支付金按协议比例发给卖家等；**
+ **负责与前端对接卖家的操作界面，保证用户操作流畅。**

**后端2：**

+ **负责管理员审核决定是否上架等需要人工审核的功能实现；**
+ **负责买家看商品、买家决定是否出价、出价发送卖家、买卖家交流、买家收货系统将账号信息发送给买家、买家验货等与买家相关的功能实现；**
+ **负责处理卖家提交账号或交易问题、将交易放入问题备案等相关问题的处理。**

以上分配仅供参考，可以根据具体情况进行调整。如果两个后端能力相当，这样的分配应该能够保证工作的高效和协作的顺畅。